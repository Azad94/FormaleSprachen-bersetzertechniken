package lexer_parser;

import lexer_parser.Lexer;
import lexer_parser.Token;

public class RecDesLexer extends Lexer {

	public static int ID = 2;
	public static int INTEGER = 3;
	public static int PLUS = 4;
	public static int MINUS = 5;
	public static int MULTI = 6;
	public static int DIV = 7;
	public static int LBRACK = 8;
	public static int RBRACK = 9;
	public static int EQUALS = 10;
	public static int NL = 11;
	public static final int UMINUS = 12;
	
	public static String[] tokenNames =  {"e/a", "EOF", "ID", "INTEGER", "PLUS", 
			"MINUS", "MULTI", "DIV", "LBRACK", "RBRACK", "EQUALS", "NL", "UMINUS" };	
	
	public RecDesLexer(String input) {
		super(input);
	}

	@Override
	public Token nextToken() {
		while( c!=EOF){
			switch( c ){
				case ' ':case '\t':case'\r':	
					WS();continue;
				case '+': return PLUS();
				case '-': return MINUS();
				case '*': return MULTI();
				case '/': return DIV();
				case '=': return EQUALS();
				case '(': return LBRACK();
				case ')': return RBRACK();
				case '\n': return NL();
				case '#': return UMINUS();
				default:
					if(isDIGIT())	return INTEGER();
					if(isLETTER())	return ID();
					throw new Error("This Character is not valid: "+c);
			}
		}
		return new Token(EOF_TYPE,"EOF");
	}
	
	private Token PLUS(){
		consume();
		return new Token(PLUS, "+");
	}

	private Token MINUS() {
		consume();
		return new Token(MINUS, "-");
	}

	private Token MULTI() {
		consume();
		return new Token(MULTI, "*");
	}
	
	private Token DIV() {
		consume();
		return new Token(DIV, "/");
	}

	private Token EQUALS() {		
		consume();
		return new Token(EQUALS, "=");
	}

	private Token LBRACK() {
		consume();
		return new Token(LBRACK, "(");		
	}

	private Token RBRACK() {
		consume();
		return new Token(RBRACK, ")");
	}

	private Token NL() {
		consume();
		return new Token(NL, "NL");		
	}

	private String rekID(String str){
		if(isLETTER() || isDIGIT() ){
			str = str + c;
			consume();
			return rekID(str);
		}
		else return str;
	}
	
	private Token ID() {
		return new Token(ID, rekID("") );	
	}

	@Override
	public String getTokenName(int tokenType) {
		return tokenNames[tokenType];
	}

	private boolean isLETTER() {
		return c>='a'&&c<='z' || c>='A'&&c<='Z'; 
	}
	
	private boolean isDIGIT(){
		return (c >= '0' && c<='9');
	}

	private String rekINTEGER( String str ){
		if( isDIGIT() ){
			str = str + c;
			consume();
			return rekINTEGER(str);
		}
		else{
			return str;
		}
	}
	
	private Token INTEGER(){
		return new Token(INTEGER, rekINTEGER("") );		
	}
	
	private Token UMINUS(){
		consume();
		return new Token(UMINUS , "#");
	}

    /** WS : (' '|'\t'|'\r')* ; // ignore any whitespace */
    void WS() {
        while ( c==' ' || c=='\t' || c=='\r' ) consume();
    }
}
